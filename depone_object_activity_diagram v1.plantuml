@startuml
title Вариант использования: Депонировать объект

|Пользователь|
start
:Отправить запрос на депонирование\n(метаданные + файлы);

|Система|
:Проверить корректность\nи полноту метаданных;
if (Метаданные корректны?) then (Да)
else (Нет)
    |Пользователь|
    :Получить ошибку валидации;
    stop
endif

|Система|
:Выполнить расчет\nкриптографического хеша файлов;
:Проверить существование\nобъекта в системе;

if (Объект найден?) then (Да)
    if (Объект принадлежит пользователю?) then (Да)
        :Определить режим\n"создание новой версии";
    else (Нет)
        |Пользователь|
        :Получить ошибку создания дубликата;
        stop
    endif
else (Нет)
    |Система|
    :Определить режим\n"создание нового объекта";
endif

:Присвоить уникальный идентификатор;
:Сохранить файлы и метаданные;
:Зафиксировать дату и время депонирования;
:Записать событие в журнал аудита;
:Индексировать объект для поиска;

|Пользователь|
:Получить подтверждение успешного депонирования;

stop
@enduml
